@model List<UsuarioSeguidoPerfil>

@if (Model != null && Model.Any())
{
    @foreach (var seguido in Model)
    {
        <div class="seguidor-item" data-id-seguido="@seguido.IdUsuarioSeguido">

            <img src="@seguido.ImagenSeguido" alt="@seguido.NombreSeguido" class="seguidor-avatar" />
            <p>@seguido.NombreSeguido</p>

            <!-- Enlace al perfil del usuario seguido -->
            <a asp-controller="Usuarios" asp-action="PerfilUser" asp-route-idusuario="@seguido.IdUsuarioSeguido">
                <img src="https://e7.pngegg.com/pngimages/649/536/png-clipart-crop-supply-computer-icons-blog-info-infographic-text.png" style="height:23px; width:23px" />
            </a>

            <!-- Botón para dejar de seguir -->
            <button class="btn btn-danger btn-sm dejar-de-seguir" style="background: none; border: none; padding: 0;">
                <img src="https://w7.pngwing.com/pngs/36/901/png-transparent-cancel-disconnect-unfollow-user-block-unroll-unsubscribe-pinpoint-interface-i-icon-thumbnail.png" style="height:23px; width:23px" />
            </button>
        </div>
    }
}
else
{
    <p>No has seguido a ningún usuario aún.</p>
}

@section Script{
    <script>
        $(document).ready(function() {
            // Manejar el clic del botón "Dejar de seguir"
            $(document).on('click', '.dejar-de-seguir', function(e) {
                e.preventDefault();

                var seguidorItem = $(this).closest('.seguidor-item');
                var idSeguido = seguidorItem.data('id-seguido');

                if (confirm('¿Estás seguro de que deseas dejar de seguir a este usuario?')) {
                    $.post('/Usuarios/DejarDeSeguir', { idSeguido: idSeguido }, function() {
                        // Eliminar el usuario de la vista inmediatamente
                        seguidorItem.remove();
                    }).fail(function() {
                        alert('Error al dejar de seguir al usuario.');
                    });
                }
            });
        });
    </script>
}
